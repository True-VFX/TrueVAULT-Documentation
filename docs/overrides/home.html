{% extends "base.html" %}

{% block content %}
<div class="md-typeset">
    <!-- Page Intro (Branding + Primary CTAs) -->
    <header class="tv-intro" aria-labelledby="tv-intro-title">
        <h1 id="tv-intro-title" class="tv-intro__title">{{ config.site_name }}</h1>
        <p class="tv-intro__tagline">{{ config.site_description }}</p>
        <nav class="tv-intro__cta" aria-label="Primary">
            <a href="{{ 'guides/quick-start/' | url }}" class="md-button md-button--primary tv-cta-primary">🚀 Get Started</a>
            <a href="{{ 'guides/' | url }}" class="md-button tv-cta-secondary">📖 Browse Guides</a>
            <a href="{{ 'reference/' | url }}" class="md-button tv-cta-tertiary">⚙️ Reference</a>
        </nav>
    </header>

    <!-- Install Hero (Install Only) -->
    <section class="tv-hero" aria-labelledby="tv-install-title">
        <div class="tv-hero__inner tv-hero__inner--solo tv-install">
            <header class="tv-install__header">
                <span class="tv-install__icon" aria-hidden="true">🧩</span>
                <h2 id="tv-install-title" class="tv-install__title">Install the Add‑on</h2>
            </header>
            <p class="tv-install__desc">Drag the button into an open Blender window ({{ page.meta.blender_version_target or '4.5+' }}). Need help? See the <a href="{{ 'guides/quick-start/' | url }}">Quick Start</a> guide.</p>
            <div class="truevault-install-action" data-install-url="https://vault.true-vfx.xyz/true_vault.zip?repository=%2Ffunctions%2Fv1%2Fget-repo&blender_version_min=4.5.0">
                <div class="tv-install__action-wrap">
                    <a class="md-button md-button--primary truevault-drag-button tv-install__drag" draggable="true" ondragstart="handleDragStart(event)" aria-describedby="tv-install-meta" aria-label="Drag to Blender to install TrueVAULT" title="Drag to Blender to install TrueVAULT">
                        <span class="twemoji" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M13 11h5l-1.5-1.5 1.42-1.42L21.84 12l-3.92 3.92-1.42-1.42L18 13h-5v5l1.5-1.5 1.42 1.42L12 21.84l-3.92-3.92L9.5 16.5 11 18v-5H6l1.5 1.5-1.42 1.42L2.16 12l3.92-3.92L7.5 9.5 6 11h5V6L9.5 7.5 8.08 6.08 12 2.16l3.92 3.92L14.5 7.5 13 6v5Z"/></svg></span>
                        <span class="tv-install__drag-label">Drag & Drop into Blender</span>
                    </a>
                    <!-- <div class="tv-install__alt">
                        <a class="tv-install__download" href="https://vault.true-vfx.xyz/true_vault.zip?repository=%2Ffunctions%2Fv1%2Fget-repo&blender_version_min=4.5.0" download>⬇️ Direct Download</a>
                    </div> -->
                </div>
            </div>
            <ul id="tv-install-meta" class="tv-install__meta">
                <li>Requires <a href="https://www.blender.org/download/lts/4-5/">Blender {{ page.meta.blender_version_target or '4.5+' }}</a></li>
                <li><a href="{{ 'guides/quick-start/#troubleshooting' | url }}">Troubleshooting</a></li>
            </ul>
        </div>
        <script>
            function handleDragStart(event) {
                const action = event.target.closest('.truevault-install-action');
                if (!action) return;
                const installUrl = action.getAttribute('data-install-url');
                if (!installUrl) return;
                event.dataTransfer.setData('text/uri-list', installUrl);
                event.dataTransfer.setData('text/plain', installUrl);
                event.dataTransfer.effectAllowed = 'copy';
                event.target.classList.add('dragging');
            }
            document.addEventListener('DOMContentLoaded', () => {
                const dragBtn = document.querySelector('.truevault-drag-button');
                const action = document.querySelector('.truevault-install-action');
                if (dragBtn) dragBtn.addEventListener('dragend', e => e.target.classList.remove('dragging'));
                // Click fallback for mobile / accessibility.
                if (dragBtn && action) {
                    const url = action.getAttribute('data-install-url');
                    if (url) dragBtn.setAttribute('href', url);
                }
                // Drag-drop capability detection & advisory message
                const supportsDrag = ('draggable' in document.createElement('span')) && (typeof DataTransfer !== 'undefined');
                const touch = matchMedia('(pointer:coarse)').matches;
                if ((!supportsDrag || touch) && action) {
                    const note = document.createElement('p');
                    note.className = 'tv-install__hint';
                    note.textContent = 'On this device, use the Direct Download instead of drag & drop.';
                    action.appendChild(note);
                }
            });
        </script>
    </section>

    <!-- Feature Cards Grid -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
        
        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                ⚡ Quick Start
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Get up and running with TrueVAULT in minutes. Install the add-on and start browsing assets immediately.</p>
            <a href="{{ 'guides/quick-start/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Get Started
            </a>
        </div>

        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                🔍 Browse Assets
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Discover thousands of high-quality assets with powerful filtering and search capabilities.</p>
            <a href="{{ 'guides/browse-assets/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Browse Assets
            </a>
        </div>

        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                💾 Import & Manage
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Import assets directly into Blender and manage versions, updates, and variants effortlessly.</p>
            <a href="{{ 'guides/import-assets/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Import Guide
            </a>
        </div>

        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                💳 Purchase & Credits
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Buy assets with credits, manage your purchases, and handle licensing seamlessly.</p>
            <a href="{{ 'guides/buy-products/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Buy Products
            </a>
        </div>

        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                ⚙️ Reference
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Complete reference for all panels, operators, properties, and technical details.</p>
            <a href="{{ 'reference/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Reference
            </a>
        </div>

        <div class="md-typeset" style="border: 1px solid var(--md-default-fg-color--lightest); border-radius: 8px; padding: 1.5rem; background: var(--md-default-bg-color);">
            <h3 style="margin-top: 0; display: flex; align-items: center; gap: 8px;">
                ❓ Troubleshooting
            </h3>
            <hr style="margin: 1rem 0;">
            <p>Solve common issues and get help with performance, authentication, and import problems.</p>
            <a href="{{ 'troubleshooting/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">
                → Get Help
            </a>
        </div>

    </div>

    <!-- Quick Actions Section -->
    <div style="background: var(--md-default-bg-color--light); padding: 2rem; border-radius: 8px; margin-top: 3rem;">
        <h2 style="display: flex; align-items: center; gap: 8px;">✨ Quick Actions</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
            <div>
                <h3 style="display: flex; align-items: center; gap: 8px;">👤 Account Setup</h3>
                <p>Configure your profile and authentication</p>
                <a href="{{ 'guides/account-profile/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">→ Account Guide</a>
            </div>
            <div>
                <h3 style="display: flex; align-items: center; gap: 8px;">🏷️ Tags & Categories</h3>
                <p>Learn to use filtering and organization</p>
                <a href="{{ 'guides/tags-categories/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">→ Organization Guide</a>
            </div>
            <div>
                <h3 style="display: flex; align-items: center; gap: 8px;">💾 Offline Mode</h3>
                <p>Set up caching for offline workflows</p>
                <a href="{{ 'guides/offline-caching/' | url }}" style="color: var(--md-primary-fg-color); text-decoration: none; font-weight: 500;">→ Caching Guide</a>
            </div>
        </div>
    </div>

</div>
{% endblock %}
